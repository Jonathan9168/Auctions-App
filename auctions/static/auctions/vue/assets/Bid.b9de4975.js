import{d as h,_ as m,o as d,c,a as i,t as l,F as u,e as p}from"./index.ed948278.js";const b=h({data(){return{id:this.$route.params.id,bids:[],current:0,item:[]}},components:{},methods:{async send_bid(){await this.get_id();let t=document.getElementById("typePriceX").value;if(t=parseInt(t),console.log(t,this.current),!t){alert("Please enter a number in the field");return}if(t<this.current){alert("Your bid must be higher than the current bid");return}let s={bid:t,user:await this.get_id(),item:this.id};await fetch("http://127.0.0.1:8000/api/bids/",{method:"POST",body:JSON.stringify(s),headers:{"X-CSRFToken":this.getCookie()}}),this.get_bids()},async get_bids(){let e=await fetch("http://127.0.0.1:8000/api/bids/",{method:"GET"}),t=+this.id;var r=(await e.json()).bids.filter(function(o,n){return o.item===t},t);this.bids=r,this.bids.length==0?this.current=this.item[0].starting_price:this.current=r.at(-1).price},formatDate(e){var t=new Date(e).getHours(),s=new Date(e).getMinutes(),r=t>=12?"pm":"am";t=t%12,t=t||12;var o=s<10?"0"+s:s,n=t+":"+o+" "+r;return new Date(e).getDate()+"/"+(new Date(e).getMonth()+1)+"/"+new Date(e).getFullYear()+"  "+n},async get_id(){return(await(await fetch("http://127.0.0.1:8000/api/uid/",{method:"GET"})).json()).id},async fetch_item(){let e="http://127.0.0.1:8000/api/item/"+this.id+"/",t=await fetch(e,{method:"GET"});t.ok||(alert("You cannot bid for this item"),window.location.replace("http://127.0.0.1:8000/listings"));let s=await t.json();this.item=s.item},getCookie(){let e="";if(document.cookie&&document.cookie!=="")for(var t=document.cookie.split(";"),s=0;s<t.length;s++){var r=t[s].trim();if(r.substring(0,10)==="csrftoken="){e=decodeURIComponent(r.substring(10));break}}return e}},mounted(){this.fetch_item(),this.get_bids()}}),_={class:"vh-50 gradient-custom"},f={class:"container py-5 h-50"},g={class:"row d-flex justify-content-center align-items-center h-50"},v={class:"col-12 col-md-8 col-lg-6 col-xl-5"},w={class:"card bg-dark text-white",style:{"border-radius":"1rem"}},y={class:"card-body p-5 text-center"},k={class:"mb-md-5 mt-md-4 pb-5"},x=i("h2",{class:"fw-bold mb-2 text-uppercase card-text-colour"}," Make your Bid ",-1),D={class:"mb-1 card-text-colour2"},B=i("form",{id:"post",class:"p-1"},[i("div",{class:"form-outline form-white mb-4"},[i("label",{class:"form-label card-text-colour2",for:"typePriceX"},"Enter your bid price"),i("input",{type:"number",step:"any",id:"typePriceX",class:"form-control form-control-lg",required:""})])],-1),C={class:"text-center"},T=i("h1",null,"Bids",-1);function j(e,t,s,r,o,n){return d(),c(u,null,[i("section",_,[i("div",f,[i("div",g,[i("div",v,[i("div",w,[i("div",y,[i("div",k,[x,i("p",D," Current bid: \xA3"+l(e.current),1),B,i("button",{class:"btn btn-outline-light btn-lg px-5",onClick:t[0]||(t[0]=a=>e.send_bid()),type:"submit"}," Bid ")])])])])])])]),i("div",C,[T,(d(!0),c(u,null,p(e.bids,a=>(d(),c("div",null,[i("p",null," Time: "+l(e.formatDate(a.time_created))+" Price: \xA3"+l(a.price),1)]))),256))])],64)}const P=m(b,[["render",j]]);export{P as default};
